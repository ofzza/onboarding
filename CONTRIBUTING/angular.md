# Angular Work-Flow

## Starting a project

### Create new application project

Create a new Angular application project:

```sh
ng new ngx-myapp
```

### Create a new library project using

Create a new empty Angular project:

```sh
ng new ngx-mylib --create-application=false
```

Add a library to the project:

```sh
ng generate library ngx-mylib
```

Add a showcase application to the project:

```sh
ng generate application showcase
```

## Conventions

### Structure and naming conventions

#### Project directory structure

Every application project should internally follow the following directory structure:

| Directory                                        | Purpose                                                                                    |
| ------------------------------------------------ | ------------------------------------------------------------------------------------------ |
| `./app/`                                         | Main application module and component as pre-generated by `ng cli`                         |
| `.app/components/`                               | Reusable components and directives, shared between multiple routes and parent components   |
| `./app/pages/`                                   | Root components of application routes                                                      |
| `./app/pages/:page/components/`                  | Components and directives used only by the parent component and not reusable anything else |
| `./app/pages/:page/components/:comp/components/` | Components and directives used only by the parent component and not reusable anything else |
| `./app/services/`                                | All services                                                                               |
| `./app/services/:domain/`                        | All services pertaining to a domain (for example "api", or "auth")                         |
| `./app/data/`                                    | All application data models                                                                |
| `./app/data/:domain/`                            | All application data models pertaining to a domain (for example "auth", "users", etc ...)  |

Library projects should follow the same structure to the extent that it is applicable.

#### Directory Name Casing

When naming directories, by default all directories should be `snake-cased`. There are a large number of special cases addressed later in the "Syntax Name Casing" section ...

#### Import/Export and directory structure

All directories, `./app` and deeper, have to contain an `index.ts` file (re)exporting everything that should be accessible from the deeper structure of the directory so that other parts of the application can import while remaining agnostic of the internal structure.

<details><summary>EXAMPLE</summary>
<br>

`./app/services/myservice/helpers/DoesInternalThing.ts`

> ```ts
> export class DoesInternalThing { ... }
> ```

`./app/services/myservice/DoesUsefulThing.ts`

> ```ts
> export class DoesUsefulThing { ... }
> ```

`./app/services/myservice/DoesAnotherUsefulThing.ts`

> ```ts
> export class DoesAnotherUsefulThing { ... }
> ```

... then we would need to have an `index.ts` file (re)exporting `DoesUsefulThing` and `DoesAnotherUsefulThing`:

`./app/services/myservice/index.ts`

> ```ts
> // No need to (re)export the internal DoesInternalThing service
> export * from "./DoesUsefulThing";
> export * from "./DoesAnotherUsefulThing";
> ```

... and also an `index.ts` one level deeper (re)exporting all services:

`./app/services/index.ts`

> ```ts
> export * from "./myservice";
> ```

... and also an `index.ts` directly inside `./app` (re)exporting everything:

`./app/index.ts`

> ```ts
> export * from "./services";
> ```

... so that when importing from another part of the application, we can just do:

`./app/components/mycomponent/index.ts`

> ```ts
> import { DoesUsefulThing, DoesAnotherUsefulThing } from `../../`;
> ```

</details>

### CodeStyle

#### Check VS code configuration

For details on how to set up VS code see [here](../DEVENV/vscode.md)

#### Check JS/TS project setup

For details on how to set up a TypeScript project see [here](../DEVENV/javascript.md) and [here](../DEVENV/typescript.md)

#### TSLint and other testing

Before starting with your project, update yor project's TS lint rules by running the following:

```sh
npx json -I -f tslint.json -e "this.rules['interface-name']=true"\
                           -e "this.rules['max-line-length']=[true, 160]"\
                           -e "this.rules['member-access']=true"\
                           -e "this.rules['space-before-function-paren']=false"\
                           -e "this.rules['use-pipe-transform-interface']=true"\
                           -e "this.rules['one-variable-per-declaration']=false"\
                           -e "this.rules['member-ordering']=[true, { order: ['static-field', 'static-method', 'instance-field', 'instance-method'] }]"\
                           -e "this.rules['variable-name']={ options: ['ban-keywords','check-format','allow-leading-underscore'] }"
```

To add tests which will make sure all the nested `package.json` files in your project stay in sync, download [package.spec.ts](../RESOURCES/Angular/package.spec.ts) into the project root directory, next to `package.json`.
Run this test by running: `npx jasmine ./package.spec.ts`

#### General Syntax Name Casing

When coding, use the following name casing conventions:

| Artifact                           | Casing      |
| ---------------------------------- | ----------- |
| `function`, `variable`, `constant` | camelCase   |
| `class`, `interface`               | TitleCase   |
| `public [property or method]`\*    | camelCase   |
| `private [property or method]`\*   | \_camelCase |
| `enum`                             | TitleCase   |
| `enum value`                       | ALL_CAPS    |

`*` `public [methods or properties]` that are only exposed to be used in a component's template, but would otherwise be private should be cased as if they are `private [methods or properties]`!

There are additional rules for casing Angular specific, higher level artifacts:

<details><summary> Components </summary>
<br>

Names of directories containing components should be `TitleCase`. The name of the directory should match the name of the component with or (preferably) without the word "Component".

Names of component classes should be `TitleCase` and should end with the word "Component".

Selectors for components should be `snake-case` and start with a common prefix for the library/application, or (by default) `ngx-`.

Component's template and styling files should be named `index.html` and `style.scss`.

```ts
// Located in directory/file: "/Something/index.ts"
// ... alternatively "/SomethingComponent/index.ts"
// Accompanied by template and styling:
//  - index.html
//  - style.scss
@Component({ selector: 'ngx-something' })
exports class SomethingComponent { ... }
```

</details>

<details><summary> Directives </summary>
<br>

Names of directories containing directives should be `camelCase`. The name of the directory should match the name of the directive class with or (preferably) without the word "Directive".

Names of directive classes should be `TitleCase` and should end with the word "Directive".

Selectors for directives should be `camelCase` and start with a common prefix for the library/application, or (by default) `ngx`.

```ts
// Located in directory/file: "/doSomething/index.ts"
// ... alternatively "/doSomethingDirective/index.ts"
@Component({ selector: 'ngxDoSomething' })
exports class DoSomethingDirective { ... }
```

</details>

<details><summary> Pipes </summary>
<br>

Names of directories containing pipes should be `camelCase`. The name of the directory should match the name of the pipe class with or (preferably) without the word "Pipe".

Names of pipe classes should be `TitleCase` and should end with the word "Pipe".

Selectors/Names for pipes should be `camelCase` and start with a common prefix for the library/application, or (by default) `ngx`.

```ts
// Located in directory/file: "/doSomething/index.ts"
// ... alternatively "/doSomethingPipe/index.ts"
@Pipe({name: 'ngxDoSomething'})
export class DoSomethingPipe { ... }
```

</details>

<details><summary> Services </summary>
<br>

All services need to be implemented as classes!

Names of directories containing services should be `TitleCase`. The name of the directory should match the name of the service class with or (preferably) without the word "Service".

Names of service classes should be `TitleCase` and should NOT end with the word "Service".

```ts
// Located in directory/file: "/Something/index.ts"
// ... alternatively "/SomethingService/index.ts"
@Injectable()
export class DoSomething { ... }
```

</details>

<details><summary> Data Models </summary>
<br>

Names of directories containing data models should be `TitleCase`. The name of the directory should match the name of the data model class with or (preferably) without the word "Modal".

Names of data model classes should be `TitleCase` and should end with the word "Model".

```ts
// Located in directory/file: "/Something/index.ts"
// ... alternatively "/SomethingModel/index.ts"
export class SomethingModel { ... }
```

</details>
